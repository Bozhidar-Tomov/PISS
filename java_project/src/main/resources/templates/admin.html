<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Admin Panel</title>
    <link rel="stylesheet" href="/css/layouts/layout.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Metal+Mania&display=swap" rel="stylesheet">
</head>

<body>
    <header>
        <a class="site-title-link" href="/">
            <div class="site-title">
                <h1>Crowd Pulse</h1>
                <h2>Feel the beat of every emotion</h2>
            </div>
        </a>
        <form action="/logout" method="get" class="header-logout">
            <button type="submit" class="btn btn-secondary">Logout</button>
        </form>
    </header>

    <main class="admin-main">
        <section class="panels">
            <section class="panel" aria-label="Send Command">
                <h2 class="panel-title">Send Command</h2>
                <div id="simAudienceControl">
                    <!-- Controlled by JS via API -->
                    <button id="simAudienceBtn" type="button" class="btn btn-secondary">
                        <span id="simAudienceBtnText">Enable</span> Simulated Audience
                    </button>
                </div>
                <span id="simAudienceFeedback" style="color:#2b8a3e;"></span>

                <form id="commandForm" method="post" action="/admin/broadcast" class="form-fields">
                    <label for="commandType">Command Type:</label>
                    <select id="commandType" name="type" required>
                        <option value="applause">Applause</option>
                        <option value="cheer">Cheer</option>
                        <option value="boo">Boo</option>
                        <option value="murmur">Murmur</option>
                        <option value="stomp">Stomp</option>
                        <option value="silence">Silence</option>
                    </select>

                    <div id="intensitySliderWrapper">
                        <label for="intensity">Intensity (1-100):</label>
                        <div class="slider-container">
                            <input type="range" id="intensity" name="intensity" min="1" max="100" value="50">
                            <span id="intensityValue">50</span>
                        </div>
                    </div>

                    <label for="duration">Duration (seconds):</label>
                    <input type="number" id="duration" name="duration" min="1" max="30" value="5">

                    <label for="countdown">Countdown (seconds):</label>
                    <input type="number" id="countdown" name="countdown" min="0" max="10" value="3">

                    <label for="categories">Target Categories (comma-separated):</label>
                    <input type="text" id="categories" name="categories"
                        placeholder="e.g., VIP,section-A,premium,student">

                    <label for="gender">Target Gender:</label>
                    <select id="gender" name="gender">
                        <option value="">All</option>
                        <option value="male">Male</option>
                        <option value="female">Female</option>
                        <option value="other">Other</option>
                    </select>

                    <label for="message">Custom Message:</label>
                    <input type="text" id="message" name="message" placeholder="Optional instruction or message">

                    <div id="commandFormFeedback" class="form-feedback"></div>

                    <button type="submit" class="btn btn-primary">Send Command</button>
                </form>
            </section>

            <!-- Live Feedback Panel -->
            <section class="panel" aria-label="Live Feedback">
                <h2 class="panel-title">Live Feedback</h2>
                <div class="connection-status">
                    <div class="status-indicator" id="connectionStatus">
                        <span class="status-dot" id="statusDot"></span>
                        <span class="status-text" id="statusText">SSE Server: Checking status...</span>
                    </div>
                    <div class="last-command" id="lastCommandInfo">
                        No commands sent yet
                    </div>
                </div>
                <div class="metrics">
                    <div class="metric">
                        <label>Active Users:</label>
                        <span id="activeUsers">0</span>
                    </div>
                    <div class="metric">
                        <label>Current Volume:</label>
                        <span id="currentVolume">0 dB</span>
                    </div>
                    <div class="metric">
                        <label>Response Rate:</label>
                        <span id="responseRate">0%</span>
                    </div>
                </div>
            </section>
        </section>
    </main>

    <footer>
        <small>&copy; 2026
            <span class="project-name">Crowd Pulse</span>
            <span class="separator" aria-hidden="true">|</span>
            <span class="authors">Bozhidar Tomov, Kristian Viktorov</span>
        </small>
    </footer>
    <script>
        window.basePath = "";
    </script>
    <script src="/js/admin.js"></script>
</body>

</html>